{"openapi":"3.0.3","info":{"title":"FlowLedger API","version":"0.1.0"},"components":{"schemas":{"ErrorEnvelope":{"type":"object","properties":{"error":{"type":"object","properties":{"code":{"type":"string"},"message":{"type":"string"}},"required":["code","message"]}},"required":["error"]},"PageMeta":{"type":"object","properties":{"page":{"type":"integer","minimum":1},"limit":{"type":"integer","minimum":1},"total":{"type":"integer","minimum":0}},"required":["page","limit"]},"DashboardStats":{"type":"object","properties":{"active_clients":{"type":"integer"},"audits_in_progress":{"type":"integer"},"sipocs_completed":{"type":"integer"},"pending_interviews":{"type":"integer"}},"additionalProperties":false},"RecentAudit":{"type":"object","properties":{"audit_id":{"type":"integer"},"client_id":{"type":"integer"},"title":{"type":"string"},"status":{"type":"string"},"last_touched_utc":{"type":"string","format":"date-time"}},"required":["audit_id","client_id","title","status","last_touched_utc"]},"SipocDoc":{"type":"object","properties":{"suppliers_json":{"type":"array","items":{"type":"string"}},"inputs_json":{"type":"array","items":{"type":"string"}},"process_json":{"type":"array","items":{"type":"string"}},"outputs_json":{"type":"array","items":{"type":"string"}},"customers_json":{"type":"array","items":{"type":"string"}},"metrics_json":{"type":"object","additionalProperties":true}}},"Interview":{"type":"object","properties":{"interview_id":{"type":"integer"},"audit_id":{"type":"integer"},"persona":{"type":"string"},"mode":{"type":"string"},"scheduled_utc":{"type":"string","nullable":true,"format":"date-time"},"status":{"type":"string"},"notes":{"type":"string","nullable":true},"created_utc":{"type":"string","format":"date-time"},"updated_utc":{"type":"string","format":"date-time"}},"required":["interview_id","audit_id","persona"]},"InterviewResponse":{"type":"object","properties":{"response_id":{"type":"integer"},"interview_id":{"type":"integer"},"question_id":{"type":"string"},"answer":{"type":"string"},"created_utc":{"type":"string","format":"date-time"}},"required":["response_id","interview_id","question_id","answer"]},"Finding":{"type":"object","properties":{"audit_id":{"type":"integer"},"pain_points_json":{"type":"array","items":{"type":"string"}},"opportunities_json":{"type":"array","items":{"type":"string"}},"recommendations_json":{"type":"array","items":{"type":"string"}},"updated_utc":{"type":"string","format":"date-time"}},"required":["audit_id"]},"ProcessMap":{"type":"object","properties":{"process_map_id":{"type":"integer"},"audit_id":{"type":"integer"},"title":{"type":"string","nullable":true},"blob_path":{"type":"string"},"file_type":{"type":"string","nullable":true},"uploaded_utc":{"type":"string","format":"date-time"}},"required":["process_map_id","audit_id","blob_path"]},"UploadUrlResponse":{"type":"object","properties":{"uploadUrl":{"type":"string"},"blob_path":{"type":"string"},"contentType":{"type":"string"}},"required":["uploadUrl","blob_path","contentType"]},"ClientsOverviewItem":{"type":"object","properties":{"client_id":{"type":"integer"},"client_name":{"type":"string"},"is_active":{"type":"boolean"},"created_utc":{"type":"string","format":"date-time"},"primary_contact_name":{"type":"string","nullable":true},"primary_contact_email":{"type":"string","nullable":true},"tags":{"type":"string","nullable":true,"description":"Comma-delimited or JSON string of tags"},"engagement_count":{"type":"integer"},"pending_onboarding_tasks":{"type":"integer"},"last_activity_utc":{"type":"string","format":"date-time","nullable":true}},"required":["client_id","client_name","is_active","created_utc"]}}},"paths":{"/api/audit-sipoc":{"get":{"summary":"List SIPOC docs","tags":["SIPOC"],"parameters":[{"in":"query","name":"page","schema":{"type":"integer"}},{"in":"query","name":"limit","schema":{"type":"integer"}}],"responses":{"200":{"content":{"application/json":{"schema":{"type":"object","properties":{"status":{"type":"string","enum":["ok"]},"data":{"type":"array","items":{"$ref":"#/components/schemas/SipocDoc"}},"meta":{"$ref":"#/components/schemas/PageMeta"}}}}}}}}},"/api/audit-sipoc/{audit_id}":{"get":{"summary":"Get SIPOC by audit_id","tags":["SIPOC"],"parameters":[{"in":"path","name":"audit_id","required":true,"schema":{"type":"integer"}}],"responses":{"200":{"content":{"application/json":{"schema":{"type":"object","properties":{"status":{"type":"string","enum":["ok"]},"data":{"$ref":"#/components/schemas/SipocDoc"}}}}}}}},"put":{"summary":"Upsert SIPOC by audit_id","tags":["SIPOC"],"parameters":[{"in":"path","name":"audit_id","required":true,"schema":{"type":"integer"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SipocDoc"}}}},"responses":{"200":{"content":{"application/json":{"schema":{"type":"object","properties":{"status":{"type":"string","enum":["ok"]},"data":{"$ref":"#/components/schemas/SipocDoc"}}}}}}}}},"/api/audits":{"get":{"summary":"List audits","tags":["Audits"],"parameters":[{"in":"query","name":"page","schema":{"type":"integer","minimum":1}},{"in":"query","name":"limit","schema":{"type":"integer","minimum":1}}],"responses":{"200":{"description":"Audits list","content":{"application/json":{"schema":{"type":"object","properties":{"status":{"type":"string","enum":["ok"]},"data":{"type":"array","items":{"type":"object","properties":{"audit_id":{"type":"integer"},"client_id":{"type":"integer"},"title":{"type":"string"},"scope":{"type":"string","nullable":true},"status":{"type":"string"},"created_utc":{"type":"string","format":"date-time"},"updated_utc":{"type":"string","format":"date-time"}}}},"meta":{"$ref":"#/components/schemas/PageMeta"}}}}}}}},"post":{"summary":"Create audit","tags":["Audits"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["audit_id","client_id","title"],"properties":{"audit_id":{"type":"integer"},"client_id":{"type":"integer"},"title":{"type":"string"},"scope":{"type":"string","nullable":true},"status":{"type":"string"}}}}}},"responses":{"201":{"description":"Audit created","content":{"application/json":{"schema":{"type":"object","properties":{"status":{"type":"string","enum":["ok"]},"data":{"type":"object","properties":{"audit_id":{"type":"integer"},"client_id":{"type":"integer"},"title":{"type":"string"},"scope":{"type":"string","nullable":true},"status":{"type":"string"},"created_utc":{"type":"string","format":"date-time"},"updated_utc":{"type":"string","format":"date-time"}}}}}}}}}}},"/api/audits/{audit_id}":{"get":{"summary":"Get audit by id","tags":["Audits"],"parameters":[{"in":"path","name":"audit_id","required":true,"schema":{"type":"integer"}}],"responses":{"200":{"content":{"application/json":{"schema":{"type":"object","properties":{"status":{"type":"string","enum":["ok"]},"data":{"type":"object","properties":{"audit_id":{"type":"integer"},"client_id":{"type":"integer"},"title":{"type":"string"},"scope":{"type":"string","nullable":true},"status":{"type":"string"},"created_utc":{"type":"string","format":"date-time"},"updated_utc":{"type":"string","format":"date-time"}}}}}}}}}},"put":{"summary":"Update audit","tags":["Audits"],"parameters":[{"in":"path","name":"audit_id","required":true,"schema":{"type":"integer"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"title":{"type":"string"},"scope":{"type":"string","nullable":true},"status":{"type":"string"}}}}}}},"delete":{"summary":"Delete audit","tags":["Audits"],"parameters":[{"in":"path","name":"audit_id","required":true,"schema":{"type":"integer"}}],"responses":{"200":{"description":"Deleted"}}}},"/api/clients":{"get":{"summary":"List clients","tags":["Clients"],"parameters":[{"in":"query","name":"page","schema":{"type":"integer","minimum":1}},{"in":"query","name":"limit","schema":{"type":"integer","minimum":1}}],"responses":{"200":{"description":"Clients list","content":{"application/json":{"schema":{"type":"object","properties":{"status":{"type":"string","enum":["ok"]},"data":{"type":"array","items":{"type":"object","properties":{"client_id":{"type":"integer"},"name":{"type":"string"},"is_active":{"type":"boolean"},"created_utc":{"type":"string","format":"date-time"}}}},"meta":{"$ref":"#/components/schemas/PageMeta"}}}}}}}}},"/api/findings/{audit_id}":{"get":{"summary":"Get findings by audit_id","tags":["Findings"],"parameters":[{"in":"path","name":"audit_id","required":true,"schema":{"type":"integer"}}],"responses":{"200":{"content":{"application/json":{"schema":{"type":"object","properties":{"status":{"type":"string","enum":["ok"]},"data":{"$ref":"#/components/schemas/Finding"}}}}}}}},"put":{"summary":"Upsert findings by audit_id","tags":["Findings"],"parameters":[{"in":"path","name":"audit_id","required":true,"schema":{"type":"integer"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/Finding"}}}},"responses":{"200":{"content":{"application/json":{"schema":{"type":"object","properties":{"status":{"type":"string","enum":["ok"]},"data":{"$ref":"#/components/schemas/Finding"}}}}}}}}},"/api/interview-responses":{"get":{"summary":"List interview responses","tags":["Interview Responses"],"parameters":[{"in":"query","name":"page","schema":{"type":"integer"}},{"in":"query","name":"limit","schema":{"type":"integer"}}],"responses":{"200":{"content":{"application/json":{"schema":{"type":"object","properties":{"status":{"type":"string","enum":["ok"]},"data":{"type":"array","items":{"$ref":"#/components/schemas/InterviewResponse"}},"meta":{"$ref":"#/components/schemas/PageMeta"}}}}}}}}},"/api/interviews":{"get":{"summary":"List interviews","tags":["Interviews"],"parameters":[{"in":"query","name":"page","schema":{"type":"integer"}},{"in":"query","name":"limit","schema":{"type":"integer"}},{"in":"query","name":"sort","schema":{"type":"string"}},{"in":"query","name":"order","schema":{"type":"string","enum":["ASC","DESC"]}}],"responses":{"200":{"content":{"application/json":{"schema":{"type":"object","properties":{"status":{"type":"string","enum":["ok"]},"data":{"type":"array","items":{"$ref":"#/components/schemas/Interview"}},"meta":{"$ref":"#/components/schemas/PageMeta"}}}}}}}}},"/api/process-maps":{"get":{"summary":"List process maps","tags":["Process Maps"],"parameters":[{"in":"query","name":"page","schema":{"type":"integer"}},{"in":"query","name":"limit","schema":{"type":"integer"}}],"responses":{"200":{"content":{"application/json":{"schema":{"type":"object","properties":{"status":{"type":"string","enum":["ok"]},"data":{"type":"array","items":{"$ref":"#/components/schemas/ProcessMap"}},"meta":{"$ref":"#/components/schemas/PageMeta"}}}}}}}}},"/api/process-maps/upload-url":{"post":{"summary":"Get pre-signed upload URL for a process map file (stub)","tags":["Process Maps"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"audit_id":{"type":"integer"},"filename":{"type":"string"},"contentType":{"type":"string"}},"required":["audit_id","filename","contentType"]}}}},"responses":{"200":{"content":{"application/json":{"schema":{"type":"object","properties":{"status":{"type":"string","enum":["ok"]},"data":{"$ref":"#/components/schemas/UploadUrlResponse"}}}}}}}}},"/api/dashboard-stats":{"get":{"summary":"Get dashboard aggregate stats","tags":["Views"],"responses":{"200":{"description":"Stats","content":{"application/json":{"schema":{"type":"object","properties":{"status":{"type":"string","enum":["ok"]},"data":{"$ref":"#/components/schemas/DashboardStats"}}}}}}}}},"/api/audit-recent-touch":{"get":{"summary":"List recent audit activity","tags":["Views"],"parameters":[{"in":"query","name":"page","schema":{"type":"integer","minimum":1}},{"in":"query","name":"limit","schema":{"type":"integer","minimum":1}}],"responses":{"200":{"description":"Recent audits","content":{"application/json":{"schema":{"type":"object","properties":{"status":{"type":"string","enum":["ok"]},"data":{"type":"array","items":{"$ref":"#/components/schemas/RecentAudit"}},"meta":{"$ref":"#/components/schemas/PageMeta"}}}}}}}}},"/api/clients-overview":{"get":{"summary":"List clients overview (aggregated stats & metadata)","tags":["Views"],"parameters":[{"in":"query","name":"page","schema":{"type":"integer","minimum":1}},{"in":"query","name":"limit","schema":{"type":"integer","minimum":1}}],"responses":{"200":{"description":"Clients overview list","content":{"application/json":{"schema":{"type":"object","properties":{"status":{"type":"string","enum":["ok"]},"data":{"type":"array","items":{"$ref":"#/components/schemas/ClientsOverviewItem"}},"meta":{"$ref":"#/components/schemas/PageMeta"}}}}}}}}},"/healthz":{"get":{"summary":"Liveness","responses":{"200":{"description":"OK"}}}},"/api/health":{"get":{"summary":"API health","responses":{"200":{"description":"OK"}}}}},"tags":[]}